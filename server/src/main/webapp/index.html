<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>LOANDOC - 로그인</title>
    <meta http-equiv="refresh" content="0;url=home.html" />
    <style>
        body{font-family:Arial,Helvetica,sans-serif;background:#f6f6f6;margin:0}
    header{background:#2d6cdf;color:#fff;padding:28px 20px;text-align:center}
    main{max-width:420px;margin:60px auto;background:#f6f6f6;padding:28px;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,0.08)}
        label{display:block;margin-bottom:6px;font-weight:600}
        input{width:100%;padding:10px;border:1px solid #ccc;border-radius:6px;margin-bottom:12px}
        button{background:#2d6cdf;color:#fff;border:none;padding:10px 14px;border-radius:6px;cursor:pointer}
        .button-group{display:flex;gap:12px;align-items:center}
        .signup-btn{background:#28a745;color:#fff;border:none;padding:10px 14px;border-radius:6px;cursor:pointer;text-decoration:none;display:inline-block;text-align:center}
        .muted{color:#666;font-size:0.9em;margin-top:10px}
    /* Top navigation: two-row layout */
    nav{display:flex;flex-direction:column;gap:8px;padding:8px 0;background:#f6f6f6}
    nav a{color:#2d6cdf;text-decoration:none;font-weight:600;padding:6px 8px}
    /* Stack for LOANDOC -> 회사소개 -> 상품소개 */
    .nav-stack{display:flex;flex-direction:column;gap:6px;align-items:center}
    /* Each nav row arranges its children horizontally */
    .nav-row{display:flex;justify-content:center;gap:10px;align-items:center;flex-wrap:wrap}
    .nav-links{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    /* Mobile: 3-row grid layout (phone) */
    @media (max-width:600px){
        nav{display:grid;grid-template-columns:repeat(4,1fr);grid-template-rows:auto auto auto;gap:8px;padding:10px}
        /* row1 */
        .nav-loandoc{grid-column:1;grid-row:1;justify-self:start}
        .nav-login{grid-column:2;grid-row:1;justify-self:center}
        .nav-intro{grid-column:3;grid-row:1;justify-self:center}
        .nav-dashboard{grid-column:4;grid-row:1;justify-self:end}
        /* row2 */
        .nav-introCo{grid-column:1;grid-row:2;justify-self:start}
        .nav-signup{grid-column:2;grid-row:2;justify-self:center}
        .nav-loanAppl{grid-column:3;grid-row:2;justify-self:center}
        .nav-customer{grid-column:4;grid-row:2;justify-self:end}
        /* row3 */
        .nav-intro{grid-column:1;grid-row:3;justify-self:start}
        .nav-workerInfo{grid-column:2;grid-row:3;justify-self:center}
        .nav-loanResult{grid-column:3;grid-row:3;justify-self:center}
        /* make buttons slightly larger and readable on small screens */
        /* make buttons full-width-ish on small screens */
        .nav-button{min-width:0;padding:8px;font-size:13px}
    }
    /* Action buttons (yellow background, black text) */
        .nav-button{background:#FFD400;color:#000;border:none;padding:8px 12px;min-width:100px;height:44px;display:inline-flex;align-items:center;justify-content:center;border-radius:8px;cursor:pointer;text-decoration:none;font-weight:700;font-size:14px;flex:0 0 auto;box-sizing:border-box}
        nav{display:flex;justify-content:center;gap:10px;padding:12px 8px;background:#f6f6f6;align-items:center;flex-wrap:nowrap;overflow-x:auto;white-space:nowrap}
</style>
    <style>
    /* Column based nav (shared) */
    nav.nav-columns{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;padding:10px;background:#f6f6f6;border-radius:10px;align-items:start}
    nav.nav-columns .nav-column{display:flex;flex-direction:column;gap:12px}
    nav.nav-columns .nav-button{background:#FFD400;color:#000;border:none;padding:10px 12px;height:auto;display:block;border-radius:8px;cursor:pointer;text-decoration:none;font-weight:700;font-size:14px;width:100%;box-sizing:border-box;text-align:center}
    nav.nav-columns .nav-column:nth-child(1){padding-right:12px}
    nav.nav-columns .nav-column:nth-child(2){padding:0 12px}
    nav.nav-columns .nav-column:nth-child(3){padding-left:12px}
    nav.nav-columns .nav-column:nth-child(4){padding-left:12px}
    @media (max-width:600px){nav.nav-columns{grid-template-columns:repeat(2,1fr);gap:10px;padding:8px}nav.nav-columns .nav-button{font-size:13px;padding:8px}}
    </style>
</head>
<body>
    <header>
        <h1>외국인 근로자 신용 대출</h1>
        <p>LOANDOC</p>
    </header>
    <nav class="nav-columns" aria-label="주요 네비게이션">
        <div class="nav-column">
            <a class="nav-button" href="home.html">LOANDOC</a>
            <a class="nav-button" href="introCo.html">회사소개</a>
                <a class="nav-button" href="intro.html">상품소개</a>
        </div>
        <div class="nav-column">
            <a class="nav-button" href="login.html">로그인</a>
            <a class="nav-button" href="#" id="nav-logout">로그아웃</a>
        </div>
        <div class="nav-column">
            <a class="nav-button" href="loanAppl.html">대출조회</a>
            <a class="nav-button" href="loanDashboard.html">대출상담요청게시판</a>
        </div>
        <div class="nav-column">
            <a class="nav-button" href="dashboard.html">게시판</a>
            <a class="nav-button" href="customer.html">고객센터</a>
        </div>
    </nav>
    <main>
        <h2>로그인</h2>
        <div>
            <label for="loginId">아이디</label>
            <input id="loginId" type="text" placeholder="아이디 입력" />
            <label for="loginPwd">비밀번호</label>
            <input id="loginPwd" type="password" placeholder="비밀번호 입력" />
            <div class="button-group">
                <button id="loginBtn">로그인</button>
                <a href="signup.html" class="signup-btn">회원가입</a>
            </div>
            <div id="loginMsg" class="muted">아이디가 없으면 회원가입을 통해 계정을 생성하십시오.</div>
        </div>
    </main>
    <script>
        // redirect fallback for browsers where meta refresh may be ignored
        try{ window.location.replace('home.html'); }catch(e){}
        function loadUsers(){ return JSON.parse(localStorage.getItem('users')||'[]'); }
        // TEST MODE: bypass server auth and always redirect to workerInfo for testing
        document.getElementById('loginBtn').addEventListener('click', ()=>{
            const id = (document.getElementById('loginId').value||'').trim();
            try { localStorage.setItem('loggedInUser', id); localStorage.setItem('lastRegisteredId', id); } catch(e){}
            document.getElementById('loginMsg').textContent = '로그인 정상 — 개인정보 화면으로 이동합니다.';
            document.getElementById('loginMsg').style.color = 'green';
            setTimeout(()=>{ window.location.href = 'workerInfo.html'; }, 400);
        });

        // If user just registered, prefill loginId
        (function prefill(){
            const last = localStorage.getItem('lastRegisteredId');
            if(last){ document.getElementById('loginId').value = last; document.getElementById('loginMsg').textContent = '회원가입 완료 — 아이디가 자동 입력되었습니다.'; document.getElementById('loginMsg').style.color='green'; localStorage.removeItem('lastRegisteredId'); }
        })();
        
        // 네비게이션 로그아웃 버튼
        const navLogout = document.getElementById('nav-logout');
        if(navLogout){
            navLogout.addEventListener('click', async function(e){
                e.preventDefault();
                try {
                    const response = await fetch('/api/auth/logout', {
                        method: 'POST',
                        credentials: 'include',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 'login-id': null })
                    });
                    const result = await response.json();
                    if (result.ok) {
                        // localStorage에서 login-id 제거
                        localStorage.removeItem('login-id');
                        alert('로그아웃이 정상적으로 되었습니다');
                        window.location.href = 'login.html';
                    }
                } catch (err) {
                    console.error('Logout error', err);
                }
            });
        }
    </script>

